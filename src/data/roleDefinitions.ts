// data/roleDefinitions.ts

import type { ColorCode, FurCode } from '../types/card';
import type { RoleType } from '../types/role';

/** 毛色のレアリティスコア（ポイント計算用） */
export const COLOR_RARITY: Record<ColorCode, number> = {
  11: 12, // サビ（最レア）
  1: 11,  // 三毛
  10: 10, // トビ
  2: 9,   // 白猫
  3: 8,   // 黒猫
  8: 7,   // サバトラ
  7: 6,   // 白黒
  5: 5,   // キジ白
  9: 4,   // グレー
  0: 3,   // 茶トラ
  6: 2,   // キジトラ
  4: 1,   // 茶白（最コモン）
};

// === フラッシュ系（5枚同色）: 12種類 ===
export const FLUSH_ROLES: Record<ColorCode, { name: string; points: number }> = {
  11: { name: 'サビフラッシュ', points: 300 },
  1: { name: '三毛フラッシュ', points: 299 },
  10: { name: 'トビフラッシュ', points: 298 },
  2: { name: '白猫フラッシュ', points: 296 },
  3: { name: '黒猫フラッシュ', points: 295 },
  8: { name: 'サバトラフラッシュ', points: 288 },
  7: { name: '白黒フラッシュ', points: 282 },
  5: { name: 'キジ白フラッシュ', points: 258 },
  9: { name: 'グレーフラッシュ', points: 250 },
  0: { name: '茶トラフラッシュ', points: 226 },
  6: { name: 'キジトラフラッシュ', points: 225 },
  4: { name: '茶白フラッシュ', points: 198 },
};

// === フォーカラー系（同色4枚）: 12種類 ===
export const FOUR_COLOR_ROLES: Record<ColorCode, { name: string; points: number }> = {
  11: { name: 'サビフォーカラー', points: 277 },
  1: { name: '三毛フォーカラー', points: 213 },
  10: { name: 'トビフォーカラー', points: 197 },
  2: { name: '白猫フォーカラー', points: 180 },
  3: { name: '黒猫フォーカラー', points: 166 },
  8: { name: 'サバトラフォーカラー', points: 143 },
  7: { name: '白黒フォーカラー', points: 123 },
  5: { name: 'キジ白フォーカラー', points: 98 },
  9: { name: 'グレーフォーカラー', points: 92 },
  0: { name: '茶トラフォーカラー', points: 80 },
  6: { name: 'キジトラフォーカラー', points: 79 },
  4: { name: '茶白フォーカラー', points: 63 },
};

// === スリーカラー系（同色3枚、残り2枚が異なる色）: 12種類 ===
export const THREE_COLOR_ROLES: Record<ColorCode, { name: string; points: number }> = {
  11: { name: 'サビスリーカラー', points: 112 },
  1: { name: '三毛スリーカラー', points: 70 },
  10: { name: 'トビスリーカラー', points: 60 },
  2: { name: '白猫スリーカラー', points: 50 },
  3: { name: '黒猫スリーカラー', points: 42 },
  8: { name: 'サバトラスリーカラー', points: 35 },
  7: { name: '白黒スリーカラー', points: 29 },
  5: { name: 'キジ白スリーカラー', points: 22 },
  9: { name: 'グレースリーカラー', points: 19 },
  0: { name: '茶トラスリーカラー', points: 18 },
  6: { name: 'キジトラスリーカラー', points: 17 },
  4: { name: '茶白スリーカラー', points: 16 },
};

// === ワンペア系（同色2枚、残り3枚が異なる色）: 12種類 ===
export const ONE_PAIR_ROLES: Record<ColorCode, { name: string; points: number }> = {
  11: { name: 'サビワンペア', points: 21 },
  1: { name: '三毛ワンペア', points: 15 },
  10: { name: 'トビワンペア', points: 13 },
  2: { name: '白猫ワンペア', points: 12 },
  3: { name: '黒猫ワンペア', points: 11 },
  8: { name: 'サバトラワンペア', points: 10 },
  7: { name: '白黒ワンペア', points: 8 },
  5: { name: 'キジ白ワンペア', points: 7 },
  9: { name: 'グレーワンペア', points: 6 },
  0: { name: '茶トラワンペア', points: 5 },
  6: { name: 'キジトラワンペア', points: 4 },
  4: { name: '茶白ワンペア', points: 2 },
};

// === ファー系（毛の長さ5枚統一）: 2種類 ===
export const FUR_ROLES: Record<FurCode, { name: string; points: number }> = {
  0: { name: 'ロングファー', points: 100 },
  1: { name: 'ショートファー', points: 1 },
};

// === ツーペアのポイント定義 ===

/**
 * ツーペアのポイント表
 * キー: "min色コード-max色コード" の形式（色コードの小さい方を先に）
 * 値: ポイント
 * requirements.md の 5.6 ツーペア（2色のペア）に基づく
 */
const TWO_PAIR_POINTS: Record<string, number> = {
  // サビ(11)とのペア
  '1-11': 154,   // 三毛×サビ
  '10-11': 148,  // トビ×サビ
  '2-11': 140,   // 白猫×サビ
  '3-11': 138,   // 黒猫×サビ
  '8-11': 127,   // サバトラ×サビ
  '7-11': 121,   // 白黒×サビ
  '5-11': 108,   // キジ白×サビ
  '9-11': 103,   // グレー×サビ
  '0-11': 97,    // 茶トラ×サビ
  '6-11': 96,    // キジトラ×サビ
  '4-11': 90,    // 茶白×サビ
  // 三毛(1)とのペア
  '1-10': 116,   // 三毛×トビ
  '1-2': 114,    // 三毛×白猫
  '1-3': 109,    // 三毛×黒猫
  '1-8': 99,     // 三毛×サバトラ
  '1-7': 91,     // 三毛×白黒
  '1-5': 83,     // 三毛×キジ白
  '1-9': 81,     // 三毛×グレー
  '0-1': 75,     // 茶トラ×三毛
  '1-6': 74,     // 三毛×キジトラ
  '1-4': 64,     // 三毛×茶白
  // トビ(10)とのペア
  '2-10': 104,   // 白猫×トビ
  '3-10': 102,   // 黒猫×トビ
  '8-10': 93,    // サバトラ×トビ
  '7-10': 87,    // 白黒×トビ
  '5-10': 77,    // キジ白×トビ
  '9-10': 76,    // グレー×トビ
  '0-10': 67,    // 茶トラ×トビ
  '6-10': 65,    // キジトラ×トビ
  '4-10': 57,    // 茶白×トビ
  // 白猫(2)とのペア
  '2-3': 94,     // 白猫×黒猫
  '2-8': 88,     // 白猫×サバトラ
  '2-7': 85,     // 白猫×白黒
  '2-5': 73,     // 白猫×キジ白
  '2-9': 69,     // 白猫×グレー
  '0-2': 59,     // 茶トラ×白猫
  '2-6': 58,     // 白猫×キジトラ
  '2-4': 51,     // 白猫×茶白
  // 黒猫(3)とのペア
  '3-8': 86,     // 黒猫×サバトラ
  '3-7': 82,     // 黒猫×白黒
  '3-5': 68,     // 黒猫×キジ白
  '3-9': 62,     // 黒猫×グレー
  '0-3': 54,     // 茶トラ×黒猫
  '3-6': 53,     // 黒猫×キジトラ
  '3-4': 47,     // 黒猫×茶白
  // サバトラ(8)とのペア
  '7-8': 71,     // 白黒×サバトラ
  '5-8': 56,     // キジ白×サバトラ
  '8-9': 52,     // サバトラ×グレー
  '0-8': 45,     // 茶トラ×サバトラ
  '6-8': 44,     // キジトラ×サバトラ
  '4-8': 41,     // 茶白×サバトラ
  // 白黒(7)とのペア
  '5-7': 48,     // キジ白×白黒
  '7-9': 46,     // 白黒×グレー
  '0-7': 40,     // 茶トラ×白黒
  '6-7': 39,     // キジトラ×白黒
  '4-7': 36,     // 茶白×白黒
  // キジ白(5)とのペア
  '5-9': 38,     // キジ白×グレー
  '0-5': 34,     // 茶トラ×キジ白
  '5-6': 33,     // キジ白×キジトラ
  '4-5': 28,     // 茶白×キジ白
  // グレー(9)とのペア
  '0-9': 31,     // 茶トラ×グレー
  '6-9': 30,     // キジトラ×グレー
  '4-9': 27,     // 茶白×グレー
  // 茶トラ(0)とのペア
  '0-6': 25,     // 茶トラ×キジトラ
  '0-4': 24,     // 茶トラ×茶白
  // 茶白(4)とのペア
  '4-6': 23,     // 茶白×キジトラ
};

/**
 * ツーペアのポイントを取得
 * requirements.md の定義に基づく正確なポイントを返す
 */
export function calculateTwoPairPoints(
  color1: ColorCode,
  color2: ColorCode
): number {
  // キーを生成（小さい方を先にする）
  const minColor = Math.min(color1, color2);
  const maxColor = Math.max(color1, color2);
  const key = `${minColor}-${maxColor}`;

  const points = TWO_PAIR_POINTS[key];
  if (points === undefined) {
    throw new Error(`Unknown two pair combination: ${key}`);
  }
  return points;
}

// === フルハウスのポイント定義 ===

/**
 * フルハウスのポイント表
 * キー: "3枚色コード-2枚色コード" の形式
 * 値: ポイント
 * requirements.md の 5.4 フルハウス（3枚+2枚同色）に基づく
 */
const FULL_HOUSE_POINTS: Record<string, number> = {
  // サビ(11)が3枚の場合
  '11-1': 294,   // サビ×三毛
  '11-10': 293,  // サビ×トビ
  '11-2': 292,   // サビ×白猫
  '11-3': 290,   // サビ×黒猫
  '11-8': 287,   // サビ×サバトラ
  '11-7': 284,   // サビ×白黒
  '11-5': 279,   // サビ×キジ白
  '11-9': 278,   // サビ×グレー
  '11-0': 272,   // サビ×茶トラ
  '11-6': 271,   // サビ×キジトラ
  '11-4': 266,   // サビ×茶白
  // 三毛(1)が3枚の場合
  '1-11': 289,   // 三毛×サビ
  '1-10': 276,   // 三毛×トビ
  '1-2': 270,    // 三毛×白猫
  '1-3': 269,    // 三毛×黒猫
  '1-8': 261,    // 三毛×サバトラ
  '1-7': 255,    // 三毛×白黒
  '1-5': 243,    // 三毛×キジ白
  '1-9': 241,    // 三毛×グレー
  '1-0': 231,    // 三毛×茶トラ
  '1-6': 230,    // 三毛×キジトラ
  '1-4': 219,    // 三毛×茶白
  // トビ(10)が3枚の場合
  '10-11': 285,  // トビ×サビ
  '10-1': 275,   // トビ×三毛
  '10-2': 265,   // トビ×白猫
  '10-3': 259,   // トビ×黒猫
  '10-8': 253,   // トビ×サバトラ
  '10-7': 248,   // トビ×白黒
  '10-5': 233,   // トビ×キジ白
  '10-9': 227,   // トビ×グレー
  '10-0': 218,   // トビ×茶トラ
  '10-6': 217,   // トビ×キジトラ
  '10-4': 207,   // トビ×茶白
  // 白猫(2)が3枚の場合
  '2-11': 283,   // 白猫×サビ
  '2-1': 267,    // 白猫×三毛
  '2-10': 262,   // 白猫×トビ
  '2-3': 254,    // 白猫×黒猫
  '2-8': 247,    // 白猫×サバトラ
  '2-7': 237,    // 白猫×白黒
  '2-5': 220,    // 白猫×キジ白
  '2-9': 215,    // 白猫×グレー
  '2-0': 204,    // 白猫×茶トラ
  '2-6': 203,    // 白猫×キジトラ
  '2-4': 195,    // 白猫×茶白
  // 黒猫(3)が3枚の場合
  '3-11': 281,   // 黒猫×サビ
  '3-1': 260,    // 黒猫×三毛
  '3-10': 256,   // 黒猫×トビ
  '3-2': 252,    // 黒猫×白猫
  '3-8': 240,    // 黒猫×サバトラ
  '3-7': 229,    // 黒猫×白黒
  '3-5': 210,    // 黒猫×キジ白
  '3-9': 206,    // 黒猫×グレー
  '3-0': 194,    // 黒猫×茶トラ
  '3-6': 192,    // 黒猫×キジトラ
  '3-4': 183,    // 黒猫×茶白
  // サバトラ(8)が3枚の場合
  '8-11': 273,   // サバトラ×サビ
  '8-1': 249,    // サバトラ×三毛
  '8-10': 244,   // サバトラ×トビ
  '8-2': 238,    // サバトラ×白猫
  '8-3': 235,    // サバトラ×黒猫
  '8-7': 209,    // サバトラ×白黒
  '8-5': 190,    // サバトラ×キジ白
  '8-9': 186,    // サバトラ×グレー
  '8-0': 177,    // サバトラ×茶トラ
  '8-6': 175,    // サバトラ×キジトラ
  '8-4': 165,    // サバトラ×茶白
  // 白黒(7)が3枚の場合
  '7-11': 264,   // 白黒×サビ
  '7-1': 236,    // 白黒×三毛
  '7-10': 232,   // 白黒×トビ
  '7-2': 221,    // 白黒×白猫
  '7-3': 214,    // 白黒×黒猫
  '7-8': 202,    // 白黒×サバトラ
  '7-5': 173,    // 白黒×キジ白
  '7-9': 169,    // 白黒×グレー
  '7-0': 158,    // 白黒×茶トラ
  '7-6': 157,    // 白黒×キジトラ
  '7-4': 150,    // 白黒×茶白
  // キジ白(5)が3枚の場合
  '5-11': 246,   // キジ白×サビ
  '5-1': 208,    // キジ白×三毛
  '5-10': 200,   // キジ白×トビ
  '5-2': 191,    // キジ白×白猫
  '5-3': 188,    // キジ白×黒猫
  '5-8': 174,    // キジ白×サバトラ
  '5-7': 163,    // キジ白×白黒
  '5-9': 146,    // キジ白×グレー
  '5-0': 137,    // キジ白×茶トラ
  '5-6': 135,    // キジ白×キジトラ
  '5-4': 128,    // キジ白×茶白
  // グレー(9)が3枚の場合
  '9-11': 242,   // グレー×サビ
  '9-1': 201,    // グレー×三毛
  '9-10': 196,   // グレー×トビ
  '9-2': 189,    // グレー×白猫
  '9-3': 181,    // グレー×黒猫
  '9-8': 167,    // グレー×サバトラ
  '9-7': 156,    // グレー×白黒
  '9-5': 142,    // グレー×キジ白
  '9-0': 133,    // グレー×茶トラ
  '9-6': 132,    // グレー×キジトラ
  '9-4': 122,    // グレー×茶白
  // 茶トラ(0)が3枚の場合
  '0-11': 224,   // 茶トラ×サビ
  '0-1': 185,    // 茶トラ×三毛
  '0-10': 179,   // 茶トラ×トビ
  '0-2': 172,    // 茶トラ×白猫
  '0-3': 162,    // 茶トラ×黒猫
  '0-8': 152,    // 茶トラ×サバトラ
  '0-7': 145,    // 茶トラ×白黒
  '0-5': 131,    // 茶トラ×キジ白
  '0-9': 126,    // 茶トラ×グレー
  '0-6': 120,    // 茶トラ×キジトラ
  '0-4': 111,    // 茶トラ×茶白
  // キジトラ(6)が3枚の場合
  '6-11': 223,   // キジトラ×サビ
  '6-1': 184,    // キジトラ×三毛
  '6-10': 178,   // キジトラ×トビ
  '6-2': 171,    // キジトラ×白猫
  '6-3': 161,    // キジトラ×黒猫
  '6-8': 151,    // キジトラ×サバトラ
  '6-7': 144,    // キジトラ×白黒
  '6-5': 129,    // キジトラ×キジ白
  '6-9': 125,    // キジトラ×グレー
  '6-0': 119,    // キジトラ×茶トラ
  '6-4': 110,    // キジトラ×茶白
  // 茶白(4)が3枚の場合
  '4-11': 212,   // 茶白×サビ
  '4-1': 168,    // 茶白×三毛
  '4-10': 160,   // 茶白×トビ
  '4-2': 155,    // 茶白×白猫
  '4-3': 149,    // 茶白×黒猫
  '4-8': 139,    // 茶白×サバトラ
  '4-7': 134,    // 茶白×白黒
  '4-5': 117,    // 茶白×キジ白
  '4-9': 115,    // 茶白×グレー
  '4-0': 106,    // 茶白×茶トラ
  '4-6': 105,    // 茶白×キジトラ
};

/**
 * フルハウスのポイントを取得
 * requirements.md の定義に基づく正確なポイントを返す
 */
export function calculateFullHousePoints(
  threeColor: ColorCode,
  twoColor: ColorCode
): number {
  const key = `${threeColor}-${twoColor}`;
  const points = FULL_HOUSE_POINTS[key];
  if (points === undefined) {
    throw new Error(`Unknown full house combination: ${key}`);
  }
  return points;
}

// === ノーペア ===
export const NO_PAIR = { name: 'ノーペア', points: 0 };

/** 役タイプ別のヘルパー定数 */
export const ROLE_TYPE_PRIORITY: RoleType[] = [
  'flush',
  'fullHouse',
  'fourColor',
  'fur',
  'threeColor',
  'twoPair',
  'onePair',
  'noPair',
];
